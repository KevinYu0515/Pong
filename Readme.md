# Pong

多人連線的電子乒乓球經典遊戲，提供雙人對戰模式、多人對戰模式、混亂模式等各種遊法，設計上以 TCP 建立使用者互動介面選取進入的房間、遊玩設定、群組廣播等功能，以 UDP 建立遊戲對決的過程。套件上主要使用 ttkbootrstap 實現互動介面、pygame 實現遊戲本體。port 上的使用，Client 會任意選擇 port 與 Server 10001 port 行 TCP 連線，當有新的一局遊戲時，Server 會任意選擇 port 與 Client 進行 UDP 傳遞。

注意：Client 的 TCP 與 UDP 共用，目前遇到些奇怪的斷線問題，見如下的設計問題

## 使用方式
開啟遊戲 Server：‵python -m app.server.main`
玩家加入：‵python -m app.client.main‵

## 📝 TO DO LIST

- Stage1 登入
    - [x] username 結合 UUID
    - [x] 關閉視窗自動登出

- Stage2 主要大廳
    - [x] 顯示雙方陣營人數
    - [x] 多個玩家同步問題

- Stage3 等待畫面
    - [x] 同陣營的發言輸入框
    - [x] 顯示同陣營對話（廣播）
    - [x] 切換陣營按鈕
    - [x] 準備與取消準備按鈕
    - [x] tab 設計
    - [x] 更換請求按鈕
    - [x] 切換陣營重複 render 問題
    - [x] 更換位置 render 問題
    - [x] 等待玩家加入提醒
    - [x] 佈局預覽
    - [x] 準備狀態不同步

- Stage4 遊玩畫面
    - [x] 雙人對戰模式
    - [x] 多人對戰模式
    - [x] 混亂模式
    - [x] 遊戲結束後刪除房間
    - [x] 遊玩畫面計時器
    - [x] 碰撞判定修復
    - [x] 標記玩家
    - [x] 遊戲倒數計時開始
    - [x] 玩家斷線自動踢出並回到大廳

- 上線部屬
    - [x] docker 容器化
    - [ ] GCP

- Debug
    - [X] 重複遊玩 -> 畫面死掉
    - [x] 同時多場運行
    - [x] websocket 中斷問題 -> 結束一場遊戲就無法正常關閉 TCP
    - [x] 有遊戲執行時，其他玩家操作
    - [x] 遊戲結束時，websocket 偶爾會斷開
    - [x] 刪除正在遊玩的房間
    - [x] 時間結束時，雙方各加一分
    - [x] 混亂模式刪除自訂義時間功能
    - [x] websockets 斷開登出使用者，ex：刪除 process

- 設計問題  
    奇怪現象：有時候結束一場遊戲，TCP 會斷開連線  
    猜測：可能因為 Client UDP 與 TCP 的 port 共用，所以有時候 UDP 斷開連線時，TCP 有機率也會跟著斷開  

- 已刪除功能
    - 自動代理：需要演算法偵測與反饋
    - 顏色選擇：需要新增 UI 、修改資料庫
    - 刪除房間：需要新增 UI 、修改資料庫、群組移除
    - 更換位置前需要對方接受拒絕：需要實現群組內的端對端連線
    - 斷線措施：玩家斷線控制桿會消失

Not very important
- UI/UX 優化
    - [ ] room frame 的顯示